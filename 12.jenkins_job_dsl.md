# üöÄ Secci√≥n 12: Jenkins Job DSL

---

## üß© Introducci√≥n al Job DSL

El t√©rmino `DSL (Domain Specific Language)` hace referencia a un lenguaje dise√±ado para resolver problemas dentro
de un dominio espec√≠fico. En el caso de `Jenkins`, el `Job DSL` permite
`definir, crear y actualizar jobs usando c√≥digo`, en lugar de configurarlos manualmente desde la interfaz web.

Esto es especialmente √∫til en empresas donde se requiere:

- Est√°ndares de configuraci√≥n entre cientos de jobs.
- Versionar pipelines y plantillas.
- Automatizar despliegues de la infraestructura de CI/CD.

### üõ†Ô∏è ¬øQu√© es el plugin Jenkins Job DSL?

El plugin `Jenkins Job DSL` permite generar jobs mediante archivos escritos en `Groovy` (*`Groovy` es un lenguaje de
scripting din√°mico para la plataforma Java*). Con este plugin podemos
escribir c√≥digo que describa:

- Freestyle jobs
- Pipeline jobs
- Vistas
- Carpetas
- Configuraciones completas de la interfaz

De esta manera, Jenkins se convierte en un sistema declarativo, donde el c√≥digo es la fuente de verdad para los jobs.

> üí° Para poder usar `Job DSL` es indispensable instalar el plugin oficial: `Job DSL Plugin`

### üßµ ¬øPor qu√© usar Job DSL? (Beneficios Reales)

Los usuarios pueden describir sus jobs mediante scripts basados en `Groovy`, lo que habilita ventajas muy alineadas con
las pr√°cticas modernas de CI/CD:

#### ‚úîÔ∏è Rollbacks seguros

Puedes revertir un cambio en un job simplemente regresando a una versi√≥n anterior del script en Git.

#### ‚úîÔ∏è Historial de cambios y auditor√≠a

Cada modificaci√≥n a un job queda registrada en el control de versiones (Git), no solo en la UI de Jenkins.

#### ‚úîÔ∏è Control de versiones

Los jobs pasan a ser infraestructura como c√≥digo (IaC), facilitando:

- Revisiones por PR
- Control de calidad en cambios de pipelines
- Despliegue consistente de jobs en distintos entornos (Dev, QA, Prod)

#### ‚úîÔ∏è Automatizaci√≥n completa

Puedes crear cientos de jobs autom√°ticamente a partir de una plantilla.

### üè¢ ¬øC√≥mo se usa en empresas reales?

En el mundo profesional, `Job DSL` se emplea para:

- Definir plantillas estandarizadas para equipos completos.
- Crear jobs autom√°ticamente para nuevos repositorios.
- Evitar configuraciones manuales que producen errores humanos.
- Mantener versiones claras de los pipelines (GitOps + CI/CD).
- Generar m√∫ltiples pipelines basados en par√°metros (ej: microservicios).
- Reducir inconsistencias entre entornos o equipos.

üí° En entornos empresariales grandes, `Job DSL` convive con `Jenkins Pipeline` (declarativo o scripted).
Suele usarse as√≠:

| Uso                         | Herramienta      |
|-----------------------------|------------------|
| Crear la estructura del job | Job DSL          |
| Ejecutar el pipeline real   | Jenkins Pipeline |

## ‚öôÔ∏è Instalaci√≥n del Plugin Job DSL

Para utilizar `Job DSL` en `Jenkins`, primero debemos instalar el plugin oficial. Este plugin nos permitir√° definir
jobs mediante c√≥digo `Groovy` y habilita las herramientas necesarias para generar, actualizar y gestionar
configuraciones desde scripts.

Nos vamos a `Administrar Jenkins` ‚Üí `Plugins` y buscamos `Job DSL`, lo seleccionamos y procedemos a instalar.

![01.png](assets/section-12/01.png)

Seleccionamos `Reiniciar Jenkins cuando termina la instalaci√≥n...` y esperamos mientras se instala.

![02.png](assets/section-12/02.png)

## üå± Seed Job & Description (Fundamentos del Job DSL)

Para utilizar correctamente el `Plugin Job DSL`, lo primero que debemos crear es un `Seed Job`.

Un `Seed Job` es un job normal de Jenkins (igual que los jobs de estilo libre que hemos estado creando), pero con
la particularidad de que incluye el paso `Process Job DSLs`. Este paso le permite ejecutar
`scripts DSL escritos en Groovy` para crear o actualizar otros jobs autom√°ticamente. A partir de estos scripts es
posible:

- Crear nuevos jobs.
- Actualizar configuraciones.
- Regenerar plantillas.
- Aplicar cambios en masa.

En otras palabras:

> üß† El `Seed Job` es el `‚Äújob padre‚Äù` que genera otros jobs autom√°ticamente mediante c√≥digo.

### üîç ¬øPor qu√© existe el Seed Job?

Porque `Jenkins`, por defecto, solo ejecuta lo que le asignamos manualmente. El `Seed Job` act√∫a como
‚Äúint√©rprete‚Äù del DSL, permitiendo:

- Automatizar creaci√≥n de pipelines.
- Mantener jobs versionados.
- Facilitar la estandarizaci√≥n en equipos grandes.
- Evitar configuraciones manuales desde la UI.
- Regenerar jobs cuando cambian las plantillas.

> üí° En empresas, los `Seed Jobs` suelen correr autom√°ticamente al recibir cambios en su repositorio Git.

### üõ†Ô∏è Crear el Seed Job y configurar el DSL

Creamos un job de estilo libre llamado: `dsl-job`. Este ser√° nuestro `Seed Job` inicial.

![03.png](assets/section-12/03.png)

Dentro del job, nos dirigimos al `Build Steps` y en `+ A√±adir un nuevo paso` seleccionamos `Process Job DSLs`.

![04.png](assets/section-12/04.png)

### üìÅ Opciones del procesamiento DSL

Al agregar el paso, aparecen dos opciones:

- üî∏ Opci√≥n 1: `Use the provided DSL script`.
    - Permite escribir el c√≥digo directamente en la interfaz del job.
    - Suele usarse solo para pruebas o demos.

- üî∏ Opci√≥n 2: `Look on Filesystem`
    - Permite cargar uno o varios archivos `.groovy` desde el workspace del job.
    - Esta es la forma usada en empresas, pues el DSL se versiona en Git.

En este punto usaremos la `opci√≥n 1` para una demostraci√≥n.

![05.png](assets/section-12/05.png)

### üìù Ejemplo b√°sico de DSL Script

Al seleccionar la `opci√≥n 1`, aparece un cuadro de texto para escribir el script. Usaremos este ejemplo simple:

````bash
job('ejemplo-job-DSL') {
  
}
````

Este script indica:

> üî® Crear un nuevo job llamado `ejemplo-job-DSL` utilizando como base este seed job (`dsl-job`).

Nota:
> En el siguiente enlace https://jenkinsci.github.io/job-dsl-plugin podemos ver informaci√≥n sobre `Jenkins Job DSL API`


![06.png](assets/section-12/06.png)

### ‚ñ∂Ô∏è Ejecutando el Job DSL

Guardamos el Seed Job y luego hacemos clic en: `Construir Ahora`. Sin embargo, veremos que aparece un error:

![07.png](assets/section-12/07.png)

### üõ°Ô∏è ¬øPor qu√© aparece el error?

Porque `Jenkins`, por seguridad, `no ejecuta scripts Groovy no aprobados`. `Jenkins` requiere revisar los scripts
para evitar ejecuci√≥n de c√≥digo potencialmente peligroso.

Debemos aprobarlos manualmente:

````
Administrar Jenkins ‚Üí In-process Script Approval 
````

![08.png](assets/section-12/08.png)

### ‚úîÔ∏è Aprobando el script

Entramos a `In-Process Script Approval` y hacemos clic en: `Approve`.

![09.png](assets/section-12/09.png)

Despu√©s de aprobarlo, volvemos a ejecutar el Seed Job y veremos que ahora el build finaliza correctamente:

![10.png](assets/section-12/10.png)

### üéâ Verificando que el job fue creado

Vamos al panel principal de Jenkins y veremos que se gener√≥ un nuevo job: `ejemplo-job-DSL`.

![11.png](assets/section-12/11.png)

Y si ingresamos al job reci√©n creado, veremos la referencia: `Seed job: dsl-job`. Esto nos confirma que el job fue
creado mediante c√≥digo usando nuestro Seed Job.

![12.png](assets/section-12/12.png)

## üìÅ Source Control Management (SCM)

En esta lecci√≥n aprenderemos a integrar `GitHub` dentro de un `Job` creado mediante `Jenkins Job DSL`, indic√°ndole
desde qu√© repositorio debe clonar el c√≥digo fuente para ejecutar el pipeline o los scripts asociados.

Integrar correctamente `SCM` es fundamental en entornos empresariales, ya que:

- Permite ejecutar pipelines reproducibles.
- Garantiza que el c√≥digo provenga siempre de una fuente controlada.
- Hace posible trabajar con branching models modernos (`GitFlow`, `trunk-based development`).
- Facilita auditor√≠as y trazabilidad.

### üîç Conociendo el Git SCM Source en Job DSL

Para definir el origen del c√≥digo dentro del script DSL, utilizamos el bloque `scm { ... }`.

En la documentaci√≥n oficial del plugin:

‚û°Ô∏è [Jenkins Job DSL Plugin](https://jenkinsci.github.io/job-dsl-plugin/#method/javaposse.jobdsl.dsl.helpers.ScmContext.git)
encontraremos ejemplos como este:

![13.png](assets/section-12/13.png)

En la imagen vemos el `example-3`, mismo que se representa a continuaci√≥n.

````bash
// add user name and email options
job('example-3') {
    scm {
        git('git@git') { node -> // is hudson.plugins.git.GitSCM
            node / gitConfigName('DSL User')
            node / gitConfigEmail('me@me.com')
        }
    }
} 
````

#### üìù ¬øQu√© son `gitConfigName` y `gitConfigEmail`?

- Estos par√°metros dentro del bloque `scm` est√°n configurando la identidad que `Git` utilizar√° para firmar cualquier
  nuevo commit que Jenkins haga en el repositorio.
- Esto es el equivalente a ejecutar los siguientes comandos de Git dentro del espacio de trabajo del job de Jenkins (si
  el job hiciera un commit):
    ````bash
    git config user.name "DSL User"
    git config user.email "me@me.com" 
    ````
- `¬øSon importantes?` S√≠, porque si tu job realiza una acci√≥n que resulta en un commit (por ejemplo, actualizando un
  n√∫mero de versi√≥n o un archivo de configuraci√≥n), esta es la informaci√≥n del autor que aparecer√° en el historial de
  Git.

### üß™ Ejemplo previo usado en el curso

Anteriormente, probamos este script desde un job parametrizable de tipo Freestyle llamado `Par√°metro booleano en Job`:

````bash
#!/bin/bash
echo "Bienvenido al planeta ${PLANET}"
if [ "${AGENT}" = "true" ] 
then
	echo "Prep√°rese para la misi√≥n agente X, que la fuerza te acompa√±e."
else
	echo "Disfruta el planeta humano ${NAME}, trata de no morir"
fi
echo "..."
sleep 10
echo "¬°Suerte! La necesitar√°s." 
````

Este mismo script estar√° subido en el repositorio de GitHub del tutor en un archivo llamado `jobscript.sh`, tal como
se muestra a continuaci√≥n.

![14.png](assets/section-12/14.png)

### üõ†Ô∏è Realizando el Ejemplo con Job DSL

Nos dirigimos al `Seed Job` `dsl-job` ‚Üí `Configure` ‚Üí `Build Steps` ‚Üí `Process Job DSLs`, e insertamos lo siguiente:

````bash
job('ejemplo-job-DSL') {
  description('Job DSL de ejemplo para el curso de Jenkins')
  scm {
        git('https://github.com/macloujulian/jenkins.job.parametrizado.git', 'main') { node ->
            node / gitConfigName('Mart√≠n D√≠az')
            node / gitConfigEmail('magadiflo@gmail.com')
        }
    }
}
````

#### üí° ¬øQu√© hace este script?

- Crea un nuevo job llamado `ejemplo-job-DSL`.
- Configura `Git SCM` apuntando al repositorio `GitHub`.
- Selecciona la rama `main`.
- Define el nombre y correo del autor si Jenkins ejecuta operaciones Git.

En la siguiente imagen se observa la modificaci√≥n anterior.

![15.png](assets/section-12/15.png)

Luego de dar en `Save`, vamos a `Construir ahora`. Probablemente, el job no se ejecute y nos muestre un mensaje
de error `ERROR: script not yet approved for use`.

### üîê Mensaje de error: `script not yet approved for use`

El error `ERROR: script not yet approved for use` significa que el Groovy Sandbox de Jenkins est√° bloqueando la
ejecuci√≥n del script porque contiene m√©todos o clases que Jenkins considera potencialmente inseguros.

Cuando ejecutas un Seed Job que usa Job DSL, en realidad est√°s ejecutando un script Groovy. Jenkins tiene un mecanismo
de seguridad (el `In-process Script Approval`) para evitar que scripts maliciosos puedan da√±ar el sistema de archivos o
acceder a informaci√≥n sensible.

Para resolver esto, debemos aprobar manualmente el script del Job DSL.

![16.png](assets/section-12/16.png)

### ‚úîÔ∏è Ejecuci√≥n Exitosa

Cuando el Seed Job corre nuevamente:

- El script queda aprobado.
- El job `ejemplo-job-DSL` se crea correctamente.
- La configuraci√≥n SCM aparece con el repositorio y la rama definida.

![17.png](assets/section-12/17.png)

Dentro de este `Seed Job` llamado `dls-job` vemos un job `ejemplo-job-DSL`, ingresamos en √©l y vemos que `Git`
se ha configurado indicando el `repositorio de GitHub` y la rama `main`.

![18.png](assets/section-12/18.png)

Recordemos que el `Process Job DSLs` inicia con `job('ejemplo-job-DSL'){...}`, por eso es que la configuraci√≥n de git
y el repositorio de GitHub se aplicaron a ese job.

### üìå Conclusi√≥n

- El bloque `scm` en Job DSL permite integrar repositorios GitHub directamente en la definici√≥n de jobs.
- Es fundamental configurar nombre y email para que los commits generados por Jenkins tengan identidad clara.
- En Jenkins, los scripts DSL son Groovy y requieren aprobaci√≥n de seguridad antes de ejecutarse.
- Una vez aprobado, el job queda listo para usar el c√≥digo fuente del repositorio remoto.

## üéõÔ∏è Par√°metros en Jenkins DSL (Job DSL)

En esta lecci√≥n aprenderemos c√≥mo definir par√°metros en un Job utilizando `Jenkins Job DSL`.
Los par√°metros permiten que un job sea din√°mico, configurable y reutilizable; son ampliamente usados en entornos
reales para:

- Deploys a distintos entornos (`DEV`, `QA`, `PROD`).
- Activar o desactivar funcionalidades.
- Pasar variables a scripts (como nuestro `jobscript.sh`).
- Seleccionar versiones, ramas o artefactos.
- Cambiar comportamientos del pipeline seg√∫n valores de entrada.

### üìö Consultando documentaci√≥n oficial

En la documentaci√≥n del plugin:
‚û°Ô∏è [Jenkins Job DSL Plugin](https://jenkinsci.github.io/job-dsl-plugin/#method/javaposse.jobdsl.dsl.jobs.FreeStyleJob.parameters)

Encontramos el siguiente ejemplo b√°sico:

````bash
job('example') {
    parameters {
        booleanParam('FLAG', true)
        choiceParam('OPTION', ['option 1 (default)', 'option 2', 'option 3'])
    }
}
````

üí° ¬øQu√© hace este ejemplo?

- `booleanParam` ‚Üí crea un checkbox
- `choiceParam` ‚Üí crea una lista desplegable con opciones

Este patr√≥n es el que usaremos para definir nuestros par√°metros personalizados.

![19.png](assets/section-12/19.png)

### üõ†Ô∏è Configurando par√°metros para el ejemplo real del curso

Nuestro script `jobscript.sh` descargado desde GitHub requiere los par√°metros:

- NAME
- PLANET
- AGENT

Por lo tanto, debemos agregar esos par√°metros mediante el `DSL`. Volvemos a nuestro
`Seed Job` ‚Üí `Configure` ‚Üí `Process Job DSLs` y agregamos los par√°metros dentro del job `ejemplo-job-DSL`.

````bash
job('ejemplo-job-DSL') {
  description('Job DSL de ejemplo para el curso de Jenkins')
  scm {
        git('https://github.com/macloujulian/jenkins.job.parametrizado.git', 'main') { node ->
            node / gitConfigName('Mart√≠n D√≠az')
            node / gitConfigEmail('magadiflo@gmail.com')
        }
    }
  parameters {
    stringParam('NAME', 'Milagritos', 'Par√°metro de cadena para el Job Booleano')
    choiceParam('PLANET', ['Mercurio', 'Venus', 'Tierra', 'Marte', 'J√∫piter', 'Saturno', 'Urano', 'Neptuno', 'Plut√≥n'], 'Lista de par√°metros')
    booleanParam('AGENT', false)
  }
} 
````

![20.png](assets/section-12/20.png)

Damos en `Save` y vamos a `Construir ahora`. Si nos aparece el error `ERROR: script not yet approved for use`
ya sabemos que debemos aprobar la ejecuci√≥n de ese job en:
`Administrar Jenkins` > `In-process Script Approval`.

### üñºÔ∏è Configuraci√≥n visual en la UI

Al ejecutar el `Seed Job` y despu√©s ir al `ejemplo-job-DSL`, veremos los par√°metros listos para ser usados.

![21.png](assets/section-12/21.png)

Esto confirma que el DSL del `Seed Job` est√° creando correctamente los par√°metros en el job destino.

### ‚öôÔ∏è ¬øPor qu√© los par√°metros aparecen en `ejemplo-job-DSL`?

Porque el Seed Job ejecuta:

````bash
job('ejemplo-job-DSL') { ... } 
````

Todo lo que est√© dentro de ese bloque se aplica `al job que estamos declarando` y no al `Seed Job`.
El Seed Job solo sirve para `crear o actualizar` otros jobs. Este patr√≥n es est√°ndar en grandes empresas:

#### üß© Patr√≥n t√≠pico en entornos reales

- `Seed Job`: crea/actualiza cientos de jobs autom√°ticamente.
- `Jobs generados por DSL`: contienen toda la configuraci√≥n (SCM, par√°metros, triggers, etc.).
- La configuraci√≥n vive en c√≥digo, no en clics manuales.

### Verifica par√°metros en job `ejemplo-job-DSL`

Si damos clic en `Build with Parameters` en el job `ejemplo-job-DSL`, vemos que nos aparece los par√°metros configurados.

![22.png](assets/section-12/22.png)

## ‚è±Ô∏è Triggers & Wrappers en Jenkins Job DSL

En esta lecci√≥n aprenderemos a utilizar dos conceptos fundamentales cuando definimos jobs mediante `Jenkins Job DSL`:

- `Wrappers` ‚Üí Acciones adicionales antes/despu√©s del job.
- `Triggers` ‚Üí Programar la ejecuci√≥n de un job autom√°ticamente.

Ambos son utilizados en entornos empresariales para controlar el comportamiento de los jobs y automatizar procesos de
CI/CD.

### üéÅ Wrappers

Un `wrapper` es un bloque que permite agregar comportamientos adicionales al job, ya sea antes o despu√©s de la
ejecuci√≥n.

Ejemplos t√≠picos en empresas:

- ‚úîÔ∏è Configurar timeout.
- ‚úîÔ∏è Ejecutar el job en un entorno controlado.
- ‚úîÔ∏è Agregar timestamps a la consola.
- ‚úîÔ∏è Activar ansiColor.
- ‚úîÔ∏è Enmascarar logs con credenciales.

Aunque lo estudiaremos m√°s adelante con profundidad, podemos describirlo as√≠:

> üí° `Wrapper` = comportamiento extra antes o despu√©s de la ejecuci√≥n del job.

Ejemplo real:

````groovy
wrappers {
    timeout {
        absolute(10) // falla el job si dura m√°s de 10 minutos
    }
    timestamps() // agrega tiempo a cada l√≠nea del log
} 
````

### ‚è±Ô∏è Triggers en Jenkins

Los `triggers` permiten ejecutar un job de manera autom√°tica sin intervenci√≥n humana.

En el mundo real esto se usa para:

- Ejecutar builds diarios o nocturnos (nightly builds).
- Validar ramas peri√≥dicamente.
- Sincronizar repositorios.
- Generar reportes autom√°ticos.
- Automatizar tareas repetitivas.

En `Job DSL`, un trigger com√∫n es el `cron`.

#### üß© ¬øQu√© es un cron?

Un `cron` es una expresi√≥n que indica cu√°ndo debe ejecutarse algo. Tiene 5 campos:

````scss
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Minutos (0 - 59)
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Hora (0 - 23)
‚îÇ ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ D√≠a del mes (1 - 31)
‚îÇ ‚îÇ ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ Mes (1 - 12)
‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îå‚îÄ‚îÄ D√≠a de la semana (0 - 7)
‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ
‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ
* * * * * 
````

Ejemplos:

| Expresi√≥n   | Significa                                |
|-------------|------------------------------------------|
| `* * * * *` | Cada minuto                              |
| `0 * * * *` | Cada hora exacta                         |
| `0 0 * * *` | Todos los d√≠as a medianoche              |
| `H * * * *` | Una vez por hora, usando hashing estable |

#### üí° `H` en Jenkins

`Jenkins` incluye la letra `H (hash)` para distribuir autom√°ticamente las ejecuciones y evitar que todos los
jobs corran a la vez. Es una mejor pr√°ctica recomendada en empresas.

Ejemplo:

````bash
H/7 * * * *
````

‚û°Ô∏è `Ejecuta el job cada 7 minutos`, pero no siempre en el mismo minuto exacto. Esto balancea la carga del servidor.

### üß© Nota r√°pida sobre el formato `cron` en otros sistemas

En `Apache Camel` los `cron` usan `6 campos` porque se basan en `Quartz Cron`, que incluye el campo de segundos:

````bash
Segundos  Minutos  Horas  D√≠aMes  Mes  D√≠aSemana 
````

En `Jenkins`, en cambio, el `cron` usa el formato `Unix cl√°sico` de `5 campos`, sin segundos:

````bash
Minutos  Horas  D√≠aMes  Mes  D√≠aSemana
````

üí° Por eso en `Camel` ver√°s `expresiones con 6 asteriscos`, mientras que en `Jenkins solo 5`.

### üõ†Ô∏è Trigger en Job DSL

As√≠ se define un trigger con cron:

````groovy
triggers {
    cron('H/7 * * * *')
} 
````

### üß± DSL Completo con SCM, Par√°metros y Trigger

Aqu√≠ est√° el script completo utilizado en esta lecci√≥n:

````groovy
job('ejemplo-job-DSL') {
    description('Job DSL de ejemplo para el curso de Jenkins')
    scm {
        git('https://github.com/macloujulian/jenkins.job.parametrizado.git', 'main') { node ->
            node / gitConfigName('Mart√≠n D√≠az')
            node / gitConfigEmail('magadiflo@gmail.com')
        }
    }
    parameters {
        stringParam('NAME', 'Milagritos', 'Par√°metro de cadena para el Job Booleano')
        choiceParam('PLANET', ['Mercurio', 'Venus', 'Tierra', 'Marte', 'J√∫piter', 'Saturno', 'Urano', 'Neptuno', 'Plut√≥n'], 'Lista de par√°metros')
        booleanParam('AGENT', false)
    }
    triggers {
        cron('H/7 * * * *') // Se ejecuta cada 7 minutos
    }
}
````

La imagen muestra lo mismo que el c√≥digo anterior.

![23.png](assets/section-12/23.png)

### üñºÔ∏è Visualizaci√≥n en Jenkins

Luego de ejecutar el `Seed Job` (recordemos aprobar el script en `Manage Jenkins` ‚Üí `In-process Script Approval`).

![24.png](assets/section-12/24.png)

El job generado `ejemplo-job-DSL` mostrar√° el trigger configurado:

![25.png](assets/section-12/25.png)

Como podemos observar, en la opci√≥n `Triggers` se muestra el cr√≥n definido anteriormente. Este trigger se ejecutar√°
cada 7 minutos.
