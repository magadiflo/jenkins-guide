# ðŸ“˜ SecciÃ³n 4: Empecemos con Jenkins

---

## ðŸ—ï¸ Arquitectura de Jenkins

`Jenkins` se basa en una arquitectura distribuida que permite ejecutar tareas de automatizaciÃ³n en distintos nodos. A
continuaciÃ³n, se describen sus componentes principales.

### âš™ï¸ Jenkins Job

Un `Job en Jenkins` es una unidad de trabajo automatizada que puede realizar tareas como:

- Compilar cÃ³digo
- Ejecutar pruebas
- Generar artefactos
- Desplegar aplicaciones

Los `Jobs` son definidos por el usuario y supervisados por `Jenkins`. Por ejemplo, podrÃ­amos tener un `job` que realice
las siguientes tareas de forma automÃ¡tica:

1. Descargar el cÃ³digo fuente desde GitHub.
2. Ejecutar `mvn clean package` para compilar y generar el `.jar`.
3. Construir una imagen Docker con tu aplicaciÃ³n.
4. Ejecutar pruebas automatizadas o desplegar la app en un entorno de pruebas.

ðŸ“Œ `Objetivo principal`: automatizar tareas repetitivas del ciclo de vida del desarrollo.

### ðŸ§­ Cambios de terminologÃ­a en Jenkins

| **TÃ©rmino antiguo** | **Nuevo tÃ©rmino (actual)** | **DescripciÃ³n actualizada**                                                                                                                              |
|---------------------|----------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|
| `Master`            | **Controller**             | Es la instancia principal de Jenkins que orquesta y coordina la ejecuciÃ³n de *jobs*. Se encarga de programar, asignar tareas y gestionar los resultados. |
| `Slave`             | **Agent**                  | Es una mÃ¡quina (fÃ­sica, virtual o contenedor) que realiza los *builds* o tareas que el *controller* le asigna.                                           |
| `Build Node`        | **Node**                   | Hace referencia genÃ©rica tanto al *controller* como a los *agents*.                                                                                      |
| `Build Executor`    | **Executor**               | Permite ejecutar uno o varios *jobs* en paralelo dentro de un nodo.                                                                                      |

### ðŸ§  Jenkins Controller (antes â€œMasterâ€)

El `Controller` (anteriormente llamado `â€œMasterâ€`) es el nÃºcleo de `Jenkins`. Sus responsabilidades incluyen:

- Programar y coordinar los Jobs
- Asignar tareas a los agentes disponibles
- Supervisar la ejecuciÃ³n y registrar los resultados
- Ejecutar Jobs si no hay agentes disponibles

`Nota moderna`: Aunque histÃ³ricamente se usaban los tÃ©rminos `â€œmasterâ€` y `â€œslaveâ€`, `Jenkins` ha adoptado los
tÃ©rminos `controller` y `agent` para promover una terminologÃ­a mÃ¡s inclusiva y clara.

### ðŸ–¥ï¸ Jenkins Agent (antes â€œSlaveâ€)

Un `Agent` es una mÃ¡quina (fÃ­sica o virtual) que `ejecuta los Jobs` asignados por el Controller. Puede ser:

- Un contenedor Docker
- Una VM Linux
- Un servidor remoto

ðŸ“¦ Ejemplo tÃ­pico:

> Un Agent con entorno Java configurado que se encarga exclusivamente de compilar proyectos Spring Boot o ejecutar
> pruebas de integraciÃ³n.

### ðŸ”„ Jenkins Executor

Un `Executor` es una `unidad de ejecuciÃ³n dentro de un Agent`. Permite ejecutar mÃºltiples `Jobs` en paralelo en el
mismo nodo.

- Cada `Agent` puede tener uno o mÃ¡s `Executors`.
- Si un Agent tiene 2 Executors, puede ejecutar 2 Jobs simultÃ¡neamente.

En nuestro entorno local (`Docker Desktop`), el contenedor `Jenkins` normalmente tiene 1 executor por defecto.

### ðŸ§© Plugins de Jenkins

Los `plugins` son extensiones que amplÃ­an la funcionalidad de `Jenkins`. Existen mÃ¡s de 1800 plugins disponibles para:

- IntegraciÃ³n con Git, Maven, Docker, Slack, SonarQube, etc.
- VisualizaciÃ³n de resultados
- GestiÃ³n de credenciales
- Seguridad y autenticaciÃ³n

Los plugins son clave para adaptar Jenkins a cualquier flujo DevOps moderno.

### ðŸ§­ Resumen visual

````bash
+------------------------------------+
|      Jenkins Controller (Master)   |
|        (Orquesta y coordina)       |
+---------------+--------------------+
                |
                v
+---------------+--------------------+
|      Jenkins Agent (Slave)         |
|      (Ejecuta los builds)          |
+---------------+--------------------+
                |
                v
+---------------+--------------------+
|       Jenkins Executors            |
|       (Jobs en paralelo)           |
+---------------+--------------------+
````

Aunque en la documentaciÃ³n o interfaces antiguas aÃºn veas `â€œmasterâ€` o `â€œslaveâ€`, en la documentaciÃ³n oficial de
`Jenkins` y en las versiones recientes (2.3xx en adelante), el lenguaje correcto es:

````bash
controller + Agent architecture
````

## ðŸš€ Primer Job en Jenkins

En esta lecciÃ³n crearemos nuestro `primer Job (tarea)` en `Jenkins`, para comprender el flujo bÃ¡sico de creaciÃ³n,
ejecuciÃ³n y revisiÃ³n de resultados.

### ðŸ§© CreaciÃ³n del Job

En el panel principal de `Jenkins`, seleccionamos `â€œNueva tareaâ€` o `â€œNew Itemâ€`.

![01.png](assets/section-04/01.png)

Escribimos un nombre para nuestro Job (`Primer Job del Curso`) y seleccionamos el tipo
`Crear un proyecto de estilo libre`.

ðŸ’¡ Â¿QuÃ© es un proyecto de estilo libre?
> Es el tipo de proyecto mÃ¡s bÃ¡sico en `Jenkins`. Permite ejecutar comandos o scripts (`shell`, `batch`, etc.) y
> configurar manualmente todo el flujo sin necesidad de usar un `Jenkinsfile` o un `pipeline declarativo`.
> Es ideal para comenzar a familiarizarse con la herramienta.

![02.png](assets/section-04/02.png)

Al hacer clic en `OK`, accedemos a la configuraciÃ³n del `Job`. En el campo de `DescripciÃ³n`, agregamos un texto
explicativo como: `Primer Job del curso de Jenkins`.

![03.png](assets/section-04/03.png)

A continuaciÃ³n nos vamos al final de la pÃ¡gina y en la secciÃ³n `Build Steps` seleccionamos `Ejecutar lÃ­nea de comandos
(shell)`.

![04.png](assets/section-04/04.png)

Se abrirÃ¡ un campo donde podemos ingresar comandos como si estuviÃ©ramos en una terminal. En este ejemplo, escribimos un
comando para imprimir un mensaje.

![05.png](assets/section-04/05.png)

Al hacer clic en `Guardar`, `Jenkins` nos lleva a la pÃ¡gina principal del `Job` reciÃ©n creado.

![06.png](assets/section-04/06.png)

Para lanzar el `Job`, hacemos clic en `â€œConstruir ahoraâ€.` Veremos una ejecuciÃ³n registrada en la parte inferior con
su fecha y estado.

![07.png](assets/section-04/07.png)

Hacemos clic en el Ã­cono de ejecuciÃ³n y seleccionamos `â€œConsole Outputâ€` para ver el resultado del comando.

![08.png](assets/section-04/08.png)

La salida muestra el mensaje que escribimos en el paso anterior.

![09.png](assets/section-04/09.png)

ðŸ§  Nota tÃ©cnica
> `Jenkins` genera un script temporal con los comandos definidos y lo ejecuta internamente.
> Ejemplo: `/tmp/jenkins13962244877367196875.sh`

Finalmente, si vamos al panel de control veremos los detalles de la ejecuciÃ³n de nuestro job con los siguientes
detalles:

- Tiempo desde la Ãºltima ejecuciÃ³n exitosa.
- NÃºmero total de ejecuciones.
- Ãšltimo fallo (si lo hubo).
- DuraciÃ³n de la Ãºltima ejecuciÃ³n.

![10.png](assets/section-04/10.png)

### ðŸ’¡ ConclusiÃ³n

> Con este primer ejercicio, comprobamos que `Jenkins` puede ejecutar comandos directamente dentro de su entorno. En
> adelante, reemplazaremos estos comandos por scripts mÃ¡s avanzados que construyan, prueben y desplieguen aplicaciones
> reales.
