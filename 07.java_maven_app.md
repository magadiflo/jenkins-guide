# âš™ï¸ SecciÃ³n 7: IntegraciÃ³n de Jenkins con una App Java + Maven

---

### ðŸš€ Objetivo de la secciÃ³n

En esta secciÃ³n implementaremos un `flujo completo de IntegraciÃ³n Continua (CI)` utilizando `Jenkins`, una aplicaciÃ³n
`Java con Maven` y un repositorio alojado en `GitHub`.

El objetivo es que Jenkins `detecte cambios en el cÃ³digo fuente`, descargue automÃ¡ticamente la Ãºltima versiÃ³n,
`compile el proyecto`, `ejecute pruebas unitarias` y `genere artefactos` listos para desplegar.

ðŸ’¡ Concepto clave:

> La `IntegraciÃ³n Continua (CI)` es una prÃ¡ctica esencial en `DevOps` que permite detectar errores de integraciÃ³n
> de forma temprana, garantizando que el software estÃ© siempre en un estado funcional y desplegable.

## ðŸ”— Flujo general de integraciÃ³n continua con Jenkins

A continuaciÃ³n, se detalla el flujo de trabajo que implementaremos paso a paso:

1. ðŸ”Œ `InstalaciÃ³n de plugins y configuraciÃ³n base`. Configuraremos los plugins requeridos por `Maven`, `Git` y
   `GitHub`, asÃ­ como las variables necesarias para la ejecuciÃ³n del pipeline.
2. â¬‡ï¸ `Pull del repositorio GitHub en Jenkins`. Jenkins clonarÃ¡ automÃ¡ticamente el repositorio del proyecto Maven cada
   vez que se detecten nuevos commits.
3. ðŸ—ï¸ `ConstrucciÃ³n del proyecto con Maven`. Se ejecutarÃ¡ el comando `mvn clean install` o equivalente para compilar el
   cÃ³digo fuente y generar los artefactos (`.jar` o `.war`).
4. ðŸ§ª `EjecuciÃ³n de pruebas unitarias`. Durante el build, Maven ejecutarÃ¡ las pruebas definidas con JUnit, Mockito, u
   otros frameworks de testing configurados en el proyecto.
5. â–¶ï¸ `EjecuciÃ³n de la aplicaciÃ³n`. Finalmente, Jenkins podrÃ¡ ejecutar o desplegar la aplicaciÃ³n, ya sea localmente o
   en un contenedor Docker, dependiendo del entorno.

### âš™ï¸ Jenkins + GitHub + Maven en acciÃ³n

El flujo completo serÃ¡ similar al siguiente:

````
[GitHub Repo] â”€â”€pushâ”€â”€â–¶ [Jenkins Job] â”€â”€build+testâ”€â”€â–¶ [Artefacto Maven listo para despliegue] 
````

Cada cambio en GitHub dispararÃ¡ una nueva ejecuciÃ³n automÃ¡tica en Jenkins, garantizando que la aplicaciÃ³n Java:

- Compile sin errores.
- Pase las pruebas unitarias.
- Genere un artefacto vÃ¡lido (por ejemplo, un `.jar` funcional).

## ðŸ”Œ 1. InstalaciÃ³n de plugins y configuraciÃ³n base

### ðŸ§© InstalaciÃ³n del plugin `Maven Integration Plugin`

Para comenzar con la integraciÃ³n continua usando una aplicaciÃ³n Java con Maven, primero debemos instalar el plugin que
permite a `Jenkins` ejecutar `builds Maven`.

1. Ve a: `Administrar Jenkins` â†’ `Plugins` â†’ `Available plugins`
2. Busca: `Maven Integration`
3. Selecciona el plugin y procede con la instalaciÃ³n.

![01.png](assets/section-07/01.png)

Este plugin no solo permite ejecutar builds Maven dentro de Jenkins, sino que ademÃ¡s:

- Integra la fase de build con el ciclo estÃ¡ndar de Jenkins (detecta pom.xml, usa el Maven home configurado en Tools y
  expone pasos Maven en freestyle jobs).
- Permite el seguimiento de artefactos generados, pruebas, reportes y resultados JUnit.
- Facilita la creaciÃ³n de proyectos tipo â€œMaven projectâ€ (si no se usa Pipeline).

> ðŸ’¡ `Nota`: aunque hoy en dÃ­a casi todo se implementa con Pipelines (Jenkinsfile), muchos plugins heredados siguen
> dependiendo de esta integraciÃ³n para reportes de pruebas, cobertura, etc.

En la siguiente pantalla se mostrarÃ¡ el progreso de instalaciÃ³n. Es recomendable marcar la opciÃ³n
`â€œReiniciar Jenkins cuando finalice la instalaciÃ³nâ€` para completar la configuraciÃ³n.

![02.png](assets/section-07/02.png)

Una vez reiniciado `Jenkins`, verifica que el plugin haya sido instalado correctamente:

- Navega a: `Installed plugins`
- Busca nuevamente `Maven`
- DeberÃ¡s ver `Maven Integration Plugin` en la lista

![03.png](assets/section-07/03.png)

### ðŸ§© VerificaciÃ³n de `GitHub Branch Source Plugin`

El plugin `GitHub Branch Source Plugin` viene instalado por defecto en la mayorÃ­a de distribuciones modernas de
`Jenkins`. No es necesario instalarlo manualmente, solo comprobar que estÃ© disponible.

![04.png](assets/section-07/04.png)

Este plugin hace mucho detrÃ¡s de cÃ¡maras para que la integraciÃ³n `Jenkinsâ€“GitHub` sea moderna y automÃ¡tica:

- Detectar ramas y pull requests (PRs) dinÃ¡micamente usando la API de GitHub.
- Configura automÃ¡ticamente Webhooks para que GitHub notifique a Jenkins de nuevos commits.
- Administra credenciales y conexiones a GitHub usando la integraciÃ³n con GitHub App o tokens personales.
- Crea y actualiza jobs de manera automÃ¡tica en un Multibranch Pipeline basados en el Jenkinsfile de cada rama.

> ðŸ’¡ Esto lo vuelve ideal para equipos que usan GitHub Flow o GitHub PR Flow, ya que Jenkins se adapta a los repos sin
> necesidad de crear jobs manuales.

### ðŸ› ï¸ ConfiguraciÃ³n de Maven dentro de Jenkins

Ahora que el plugin estÃ¡ instalado, debemos configurar `Maven` como herramienta global dentro de `Jenkins` para que
pueda usarse en cualquier `Job` o `Pipeline`.

1. Ir a: `Administrar Jenkins` â†’ `Tools`
2. DesplÃ¡zate hacia el final hasta la secciÃ³n `Instalaciones de Maven`
3. Haz clic en `+ AÃ±adir Maven`

![05.png](assets/section-07/05.png)

Completa los siguientes campos:

- Name: `Maven en Jenkins`
- Instalar automÃ¡ticamente: âœ”ï¸ `activado`
- Version: dejar la predeterminada (Jenkins descargarÃ¡ la versiÃ³n estable recomendada)

![06.png](assets/section-07/06.png)

Finalmente, haz clic en `Save`.

### âš™ï¸ ExplicaciÃ³n tÃ©cnica

- `â€œInstalar automÃ¡ticamenteâ€` permite que `Jenkins` descargue y mantenga la versiÃ³n configurada de `Maven` sin
  necesidad de instalarla manualmente en el servidor.
- En entornos corporativos, es comÃºn:
    - Definir versiones especÃ­ficas de Maven.
    - Instalar Maven en un directorio controlado.
    - Apuntar Jenkins a esa instalaciÃ³n para mantener consistencia entre entornos.

ðŸ’¡ Buena prÃ¡ctica:
> Define versiones fijas de herramientas (como `Maven` y `JDK`) para evitar inconsistencias entre builds generados en
> distintos momentos.
