# ğŸš€ SecciÃ³n 15: Jenkins Pipeline

---

## ğŸ“˜ IntroducciÃ³n a Pipeline

`Jenkins Pipeline` nos da la capacidad de escribir los `Build Steps` en forma de cÃ³digo. Esto significa que podemos
definir las etapas del ciclo de `CI/CD` de manera explÃ­cita:

- `Build` â†’ Compilar la aplicaciÃ³n.
- `Test` â†’ Ejecutar pruebas automÃ¡ticas.
- `Deploy` â†’ Desplegar la aplicaciÃ³n en un entorno.

âš ï¸ `Nota pedagÃ³gica`: Estas tres etapas son las mÃ¡s comunes en cualquier proceso de integraciÃ³n y entrega continua,
y casi siempre se repiten en proyectos reales.

### ğŸ¯ Â¿Por quÃ© escribir Pipeline como cÃ³digo?

Las organizaciones modernas trabajan con el concepto de `Pipeline-as-Code`, el cual proporciona beneficios clave:

#### â­ Ventajas principales

- ğŸ“¦ `Versionamiento (SCM)`: El pipeline se guarda en un archivo (`Jenkinsfile`) dentro del repositorio, lo que permite
  rastrear cambios, hacer code review y mantener historial.
- ğŸ› ï¸ `Reproducibilidad`: Todo el proceso de compilaciÃ³n, pruebas y despliegue queda definido como cÃ³digo.
  Nada queda â€œen la memoriaâ€ del administrador.
- â™»ï¸ `AutomatizaciÃ³n real`: `Jenkins` puede ejecutar el Pipeline automÃ¡ticamente en cada push, PR o evento.
- ğŸš€ `Portabilidad entre Jobs`: Puedes copiar, clonar o refactorizar pipelines fÃ¡cilmente.
- ğŸ§ª `Estabilidad`: Menos dependencias de la interfaz grÃ¡fica â†’ menos errores humanos.

ğŸ’¡ Nota:
> En empresas, tener el `Jenkinsfile` dentro del repo es considerado la mejor prÃ¡ctica estÃ¡ndar. Queda prohibido
> depender solo de configuraciones por UI.

### ğŸ” Diferencia entre Jenkins Pipeline vs Jenkins Job DSL

Ambos permiten definir el proceso de CI/CD como cÃ³digo, pero su enfoque es distinto:

#### ğŸ§¬ Jenkins Pipeline

- Es un `tipo de Job` en Jenkins.
- Se encarga directamente del flujo de CI/CD: `Build` â†’ `Test` â†’ `Deploy`.
- La definiciÃ³n del `Pipeline` vive en un `Jenkinsfile`.

#### ğŸ­ Jenkins Job DSL

- Es un mecanismo para generar Jobs desde cÃ³digo.
- Usado para crear y configurar otros Jobs (incluidos pipelines).
- Utiliza Groovy, pero NO para el flujo CI/CD, sino para crear Jobs, vistas, carpetas, etc.

#### ğŸ¤ CÃ³mo conviven

En empresas es muy comÃºn:

- Usar `Job DSL` para crear automÃ¡ticamente:
    - carpetas
    - multibranch pipelines
    - jobs de librerÃ­as compartidas
- Usar `Pipeline` como el contenido del `Jenkinsfile` dentro del proyecto.

#### ğŸ“Œ Ejemplo tÃ­pico real:

Un repositorio `infra-jenkins` contiene los scripts DSL para generar Jobs. El repositorio de la app contiene
el `Jenkinsfile` con el pipeline real.

### ğŸ› ï¸ Formas de crear Jenkins Pipelines

Jenkins ofrece dos maneras de crear un Pipeline:

#### 1. Desde la Interfaz de Usuario (UI)

- Se crea un Job tipo `Pipeline` o `Multibranch Pipeline`.
- CÃ³digo del pipeline se escribe directamente en Jenkins o se le indica dÃ³nde estÃ¡ el `Jenkinsfile`.

#### 2. Usando DSL / Jenkinsfile (recomendado)

- Se crea un archivo `Jenkinsfile` en el repositorio.
- Jenkins detecta cambios automÃ¡ticamente.
- Es la forma usada en empresas modernas.

### ğŸ§‘â€ğŸ’» Lenguajes para escribir un Jenkins Pipeline

Jenkins tiene dos estilos principales:

#### ğŸŸ§ 1. Scripted Pipeline (Groovy puro)

- Basado en Groovy â€œclÃ¡sicoâ€.
- Muy flexible y expresivo.
- MÃ¡s difÃ­cil de mantener.
- Hoy se usa solo en casos muy especÃ­ficos.

#### ğŸŸ© 2. Declarative Pipeline (DSL moderno)

- Sigue una estructura clara: `pipeline { ... }`
- MÃ¡s legible, mÃ¡s seguro y con validaciones.
- Recomendado en empresas.
- Permite features avanzadas como:
    - environment
    - options
    - post
    - stages paralelos, etc.

> ğŸ“Œ `Mejor prÃ¡ctica actual`: Usar `Declarative Pipeline` junto con librerÃ­as compartidas para lÃ³gica compleja.

### ğŸ§± Etapas tÃ­picas de un Jenkins Pipeline

En un proyecto estÃ¡ndar, las etapas mÃ¡s comunes son:

#### ğŸ—ï¸ Build

- Compilar la aplicaciÃ³n.
- Instalar dependencias (Maven, Gradle, NPM, etc.)
- Generar artefactos (ej. .jar, .war, contenedores Docker).

#### ğŸ§ª Test

- Ejecutar pruebas unitarias, integraciÃ³n o estÃ¡ticas.
- Generar reportes (JUnit, Jacoco, SonarQube).
- Validar calidad del cÃ³digo antes de desplegar.

#### ğŸš€ Deploy

- Publicar artefactos (Artifactory, Nexus).
- Puede incluir pasos de infraestructura (Docker, Kubernetes, servidores).
- Desplegar en dev/QA/prod (Kubernetes, EC2, etc.)

### ğŸ“Œ ConclusiÃ³n

- Jenkins Pipeline convierte el ciclo de CI/CD en cÃ³digo versionable.
- Se diferencia de Job DSL en que Pipeline ejecuta directamente las etapas, mientras que DSL crea jobs.
- Puede escribirse en Groovy (Scripted) o en Declarative DSL, siendo este Ãºltimo mÃ¡s sencillo y recomendado.
- Las etapas tÃ­picas son `Build` â†’ `Test` â†’ `Deploy`, reflejando el flujo estÃ¡ndar de cualquier proyecto moderno.
